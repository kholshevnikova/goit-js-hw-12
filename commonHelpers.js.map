{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\n\n export function searchPhoto(searchImage, newPage) {\n  //  const BASE_URL = 'https://pixabay.com/api/';\n   const API_KEY = '43834463-9b577c35be085229738b1d5bb';\n  //  const picsCurrentPage = 1;\n   axios.defaults.baseURL = 'https://pixabay.com/api';\n\n    const params = {\n    key: API_KEY,\n    q: searchImage,\n    image_type: 'photo',\n    orientation: 'horizontal',\n      safesearch: 'true',\n      per_page: 15,\n      page: newPage,\n      \n    };\n    \n   return axios.get(`/`, {\n     params: {\n       ...params,\n     },\n   });\n};\n        \n    \n","export const createMarkup = images => {\n  return images\n    .map(\n      ({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => `\n      <li class=\"gallery-item\">\n            <a class=\"gallery-link\" href=\"${largeImageURL}\">\n                <img class=\"gallery-img\" src=\"${webformatURL}\" alt=\"${tags}\" />\n            </a>\n            <div class=\"gallery-text-container\">\n                <p class=\"gallery-text-description\"><span>likes</span>${likes}</p>\n                <p class=\"gallery-text-description\"><span>views</span>${views}</p>\n                <p class=\"gallery-text-description\"><span>comments</span> ${comments}</p>\n                <p class=\"gallery-text-description\"><span>downloads</span>${downloads}</p>\n            </div>\n        </li>`\n    )\n    .join('');\n};","import { searchPhoto } from \"./js/pixabay-api\";\nimport { createMarkup } from \"./js/render-functions\";\n\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\n\n\nlet lightbox = new SimpleLightbox('.gallery a', {\n    captionsData: 'alt',\n    sourceAttr: 'href',\n  captionDelay: 250,\n});\n\nconst searchForm = document.querySelector('.search-form');\n// console.log(searchForm);\nconst searchInfo = document.querySelector('.js-search-input');\n// console.log(searchInfo);\nconst galleryEl = document.querySelector('.gallery');\nconst loaderEl = document.querySelector('.loader');\nconst loadBtn = document.querySelector('.load-more');\n// console.log(loadBtn);\n\nlet picsCurrentPage = 1;\nlet searchQuery = '';\nlet perPage = 15;\nlet totalPages = 0;\n\n\n\n\nsearchForm.addEventListener('submit', onSearch);\n\nasync function onSearch(event) {\n    event.preventDefault();\n    const form = event.currentTarget;\n    searchQuery = form.elements.searchKeyword.value.trim();\n    \n    if (searchQuery === '') {\n        galleryEl.innerHTML = '';\n        event.target.reset();\n        iziToast.show({\n            message: 'Input field can not be empty',\n            position: 'topRight',\n            timeout: 2000,\n            color: 'red',\n        });\n\n        return;\n    }\n    galleryEl.innerHTML = '';\n    loaderEl.classList.remove('is-hidden');\n    loadBtn.classList.add('is-hidden'); //new\n    picsCurrentPage = 1;\n    \n    try {\n        const { data } = await searchPhoto(searchQuery, picsCurrentPage)\n        // console.log(data);\n        if (data.total === 0) {\n            iziToast.error({\n                message: 'Sorry, there are no images matching your search query. Please try again!',\n                position: 'topRight',\n                timeout: 2000,\n                color: 'red',\n            });\n            loaderEl.classList.add('is-hidden');\n            return;\n        }\n\n        galleryEl.innerHTML = createMarkup(data.hits);\n        lightbox.refresh();\n        \n        \n        \n\n        totalPages = Math.ceil(data.total / perPage);\n        // console.log(totalPages);\n\n        if (totalPages > 1) {\n         loadBtn.classList.remove('is-hidden');   \n        }\n        loadBtn.addEventListener('click', onLoadMorePressed);\n        \n    \n    } catch (error) {\n        console.log(error);\n    }\n \n\n    event.target.reset();\n    loaderEl.classList.add('is-hidden');\n    \n\n}\n\nconst smoothScrollOnLoadMore = () => {\n    const lastArticle = galleryEl.querySelector('.gallery-item:last-child');\n    \n  const newsArticleHeight = lastArticle.getBoundingClientRect().height;\n  const scrollHeight = newsArticleHeight * 2;\n//   console.log(scrollHeight);\n\n  window.scrollBy({\n    top: scrollHeight,\n    left: 0,\n    behavior: 'smooth',\n  });\n};\n\nconst onLoadMorePressed = async (event) => {\n    picsCurrentPage += 1;\n    loaderEl.classList.remove('is-hidden');\n    try {\n        //  console.log(picsCurrentPage);\n      const { data } = await searchPhoto(searchQuery, picsCurrentPage);\n        galleryEl.insertAdjacentHTML('beforeend', createMarkup(data.hits)); \n        smoothScrollOnLoadMore();\n        lightbox.refresh();\n    if (picsCurrentPage >= totalPages) {\n        \n        loadBtn.classList.add('is-hidden');\n        iziToast.show({\n                message: \"We are sorry, but you've reached the end of search results.\",\n                position: 'topRight',\n                timeout: 2000,\n                color: 'blue',\n            });\n        loadBtn.removeEventListener('click', onLoadMorePressed);\n\n        \n    }  \n    } catch (error) {\n       console.log(error); \n    }\n    loaderEl.classList.add('is-hidden');\n}\n\nloadBtn.addEventListener('click', onLoadMorePressed); \n\n\n\n\n\n\n\n\n"],"names":["searchPhoto","searchImage","newPage","API_KEY","axios","params","createMarkup","images","webformatURL","largeImageURL","tags","likes","views","comments","downloads","lightbox","SimpleLightbox","searchForm","galleryEl","loaderEl","loadBtn","picsCurrentPage","searchQuery","perPage","totalPages","onSearch","event","iziToast","data","onLoadMorePressed","error","smoothScrollOnLoadMore","scrollHeight"],"mappings":"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"}